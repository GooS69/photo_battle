{% extends 'post/base.html' %}

{% block content %}
    {% load static %}


    <div class="album py-2 bg-light">
        <div class="container">
            <div class="row row-cols-1 py-3">
                <div class="col ">
                    <p>
                    <form id="filterForm" method="get">
                        Find:
                        <input name="filter" type="text" value="{{ filter }}">
                    </form>
                    </p>
                    <p>
                        Sorting by:
                        <button type="button" class="btn btn-outline-primary btn-sm" onclick="getPosts('{% url 'post:post_list' '-number_of_likes' %}')">Likes</button>
                        <button type="button" class="btn btn-outline-primary btn-sm" onclick="getPosts('{% url 'post:post_list' '-number_of_comments' %}')">Comments</button>
                        <button type="button" class="btn btn-outline-primary btn-sm" onclick="getPosts('{% url 'post:post_list' '-pub_date' %}')">Pub date</button>
                    </p>
                </div>
            </div>
            <div id="postsElem">
                {% include "post/components/post_list.html" %}
            </div>
        </div>
    </div>

    <script>

        async function getPosts(url){
            let response = await fetch(url)
            if (response.ok){
                let result = await response.text()
                document.getElementById("postsElem").innerHTML = result
            }
        }

        async function getPage(url, page){
            let response = await fetch(url + '?page=' + String(page))
            if (response.ok){
                let result = await response.text()
                document.getElementById("postsElem").innerHTML = ''
                document.getElementById("postsElem").innerHTML = result
            }
        }
    </script>

{% endblock %}
